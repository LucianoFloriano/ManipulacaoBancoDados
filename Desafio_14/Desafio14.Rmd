---
title: "Desafio14"
author: "Gustavo Zanareli Andrade"
date: "2025-10-30"
output: html_document
---

# O R além de não aguentar algumas funções pelo python, a renderização do arquivo teve problemas.#

1. Importe o conjunto de dados diamonds, cujo arquivo está disponível no website da disciplina.

```{python}
# Importando os pacotes necessários
import pandas as pd
#import numpy as np
#import matplotlib.pyplot as plt
#import os
#from IPython.display import Image
#from plotnine import ggplot, aes, geom_line, geom_point, geom_smooth, labs, theme_minimal, facet_wrap, theme, element_text, facet_grid, scale_y_log10, scale_x_log10
#from plotnine.scales import scale_y_log10 
```

```{python}
diretorio = "C:/Users/ZANA/OneDrive/Desktop/Unicamp/ME's/ME315/Desafios/"

# Carregando os dados "diamonds"
from plotnine.data import diamonds
print(diamonds)
```

2. Crie uma visualização de dados que descreva a associação existente entre as variáveis peso (carat) e preço (price). Que ações você tomou para garantir que você produziu um gráfico de boa qualidade? Escreva um parágrafo comunicando os seus achados.

```{python}
# Gráfico de dispersão com ajustes para melhor visualização

graf1 = (ggplot(diamonds, aes(x='carat', y='price')) +
         geom_point(alpha=0.2, size=0.5, color='#2E86AB') +  
         geom_smooth(method='lm', color='#A23B72', se=True) +  
         labs(title='Relação entre Peso e Preço dos Diamantes',
              x='Peso (quilates)', 
              y='Preço (USD)') +
         theme_minimal() +
         theme(plot_title=element_text(size=14, ha='center')))
```

```{python}
# graf1.save(diretorio + "exercicio2.png", height=7, width=10, dpi=150)
```




Para produzir um bom gráfico, utilizei transparência nos pontos para reduzir sobreposição (por haver muitos dados), adicionei uma linha de tendência linear, pelo método 'lm' uma vez que o método 'loess' não foi suportado pelo R, para mostrar o padrão geral e escolhi cores contrastantes para melhor legibilidade. Os achados mostram uma relação positiva não-linear entre peso e preço, onde diamantes maiores são significativamente mais caros, com aumento acelerado de preço para diamantes acima de 2-3 quilates.

3. A relação identificada na questão anterior é a mesma relação presente nos diferentes cortes de diamantes? Crie uma visualização que demonstre seus achados eficientemente. Descreva sua conclusão em um parágrafo.

```{python}
# Visualização por categoria de corte

graf2 = (ggplot(diamonds, aes(x='carat', y='price')) +
         geom_point(alpha=0.15, size=0.4, color='#2E86AB') +
         geom_smooth(method='loess', color='#A23B72', se=False, size=0.8) +
         facet_wrap('~ cut', nrow=2) +
         scale_y_log10() +  # Escala log no eixo y
         labs(title='Relação Peso-Preço por Categoria de Corte (Escala Log)',
              x='Peso (quilates)',
              y='Preço (USD) - Escala Log') +
         theme_minimal())
```

```{python}
graf2.save(diretorio + "exercicio3.png", height=9, width=12, dpi=150)
```


A relação entre peso e preço é contínua e positiva em todos os cortes, mas com algumas diferenças visíveis. Diamantes com corte "Ideal" e "Premium" apresentam preços mais elevados para o mesmo peso, enquanto cortes "Fair" e "Good" têm valores relativamente menores. A qualidade do corte influencia intensamente o valor além do peso.

4. Crie uma visualização que mostre a relação entre preço e peso do diamante, considerando as diferentes combinações de qualidade de corte, cor e clareza do diamante. Quais foram as dificuldades encontradas? A relação entre preço e peso é a mesma para diferentes configurações de diamantes?

```{python}
# Criando uma amostra para evitar sobrecarga visual
 amostra = diamonds.sample(n=3000, random_state=42)

## Agrupando categorias menos frequentes para simplificar
amostra['clarity_simplified'] = amostra['clarity'].replace({
    'IF': 'IF/VVS1', 'VVS1': 'IF/VVS1',
    'VVS2': 'VVS2/VS1', 'VS1': 'VVS2/VS1',
    'VS2': 'VS2/SI1', 'SI1': 'VS2/SI1',
    'SI2': 'SI2/I1', 'I1': 'SI2/I1'
})

graf3 = (ggplot(amostra, aes(x='carat', y='price')) +
         geom_point(alpha=0.5, size=1.2, color='#F18F01') +
         geom_smooth(method='lm', color='#2E86AB', se=False, size=0.8) +
         facet_grid('color ~ cut') +
         scale_y_log10() +
         labs(title='Relação Peso-Preço por Cor e Corte',
              x='Peso (quilates)',
              y='Preço (USD) - Escala Logarítmica') +
         theme_minimal() +
         theme(strip_text=element_text(size=7),
               panel_spacing=0.4,  # Mais espaçamento entre painéis
               plot_title=element_text(size=11, ha='center')))
```

```{python}
graf3.save(diretorio + "exercicio4.png", height=16, width=24, dpi=150)
```

![Relação por Cor e Corte](C:/Users/ZANA/OneDrive/Desktop/Unicamp/ME's/ME315/Desafios/exercicio4.png)

As principais dificuldades foram o grande número de combinações (35 painéis), necessitando da amostragem e simplificação da variável clareza, além de quê o gráfico mal cabe na imagem, de tanta informação condensada. A relação entre preço e peso não é a mesma para diferentes configurações - diamantes com melhor combinação de cor e corte (D/E com Ideal/Premium) mostram preços claramente mais altos para o mesmo peso, enquanto combinações inferiores têm valores relativamente menores, levando a acreditar que atributos qualitativos modulam significativamente como o peso influencia no valor.